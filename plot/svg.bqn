# SVG utilities
Enc â‡ {
  DeNest â† {(3âŒŠâ‰¡)â—¶âŸ¨!âˆ˜0,â‹ˆ,âŠ¢,âˆ¾ğ•ŠÂ¨âŸ© â¥Šğ•©}
  open â† âˆ¾âŸ¨"<",ğ•¨,">"âŸ©
  closeâ† âˆ¾âŸ¨"</", (âˆ§`ğ•¨â‰ ' ')/ğ•¨, ">"âŸ©
  l â† 1 < dâ†â‰¡ğ•©
  âˆ¾ open ({"  "âŠ¸âˆ¾Â¨(âˆ¾DeNestÂ¨)âŸ(3â‰¤d)â¥Šğ•©}âŸl ğ•©){ğ•¨â€¿ğ•—â€¿ğ•©}â—‹(â¥Šâˆ˜<âŸl) close
}
At1 â† " " âˆ¾ {âˆ¾âŸ¨ğ•¨,"='",ğ•©,"'"âŸ©}Â´
Attr â‡ âˆ¾âŸœ(âˆ¾ <âˆ˜At1â‰1)
At â‡ {
  _s â† {((+`Ã—Â¬)âŠ¸-ğ•—âŠ¸=)âŠ¸âŠ”}
  ğ•¨ >âŠ˜(âˆ¾âŸœ(âˆ¾At1Â¨)) '='_sÂ¨ '|'_s ğ•©
}
Elt â‡ {âˆ¾âŸ¨"<",ğ•©,"/>"âŸ©}Attr
Trim â† {zâ†('0'=ğ•©)âˆ¨dâ†'.'=ğ•© â‹„ zâˆ§â†©tâ†âˆ¨`d â‹„ Â¬âˆ§`âŒ¾âŒ½zâˆ¨(4â¥Š0)Â»t}âŠ¸/
Num â‡ ('Â¯' (âŠ¢+=Ã—'-'âŠ¸-) Trimâˆ˜(â€¢Repr (âˆ=|)â—¶âŸ¨(5eÂ¯4Ã—Ã—)âŠ¸+,1e5Ã—Ã—âŸ©))âš‡0
Pos â‡ âŸ¨"x","y"âŸ© â‰Ë˜ Num
SVG â‡ {
  a â† âŸ¨"viewBox",1â†“âˆ¾' 'âˆ¾Â¨Num ğ•¨âŸ©âˆ¾"height"â€¿"width"â‰Ë˜Num 1.5Ã—âŒ½2â†“ğ•¨
  a âˆ¾â†© "xmlns"â€¿"http://www.w3.org/2000/svg"
  ("svg" Attr a) Enc ğ•©
}

_esc_ â† { ch _ğ•£_ es ğ•©:
  s â† âˆ¨âŸœÂ» m â† (â‰ ch) > i â† châŠğ•©
  âˆ¾ ((m/i)âŠes)âŒ¾((0âˆ¾s/m)âŠ¸/) ğ•©âŠ”Ëœ+`sâˆ¾1
}
Escape â† """&<>" _esc_ (("&"âˆ¾âˆ¾âŸœ";")Â¨"quot"â€¿"amp"â€¿"lt"â€¿"gt")

# Specific elements
Ge â‡ "g"âŠ¸AtâŠ¸Enc
Rdim â‡ Posâˆ˜âŠâˆ¾"width"â€¿"height"â‰Ë˜Â·NumâŠ¢Ë
Rect â‡ "rect" Elt RdimâŠ˜(AtâŠ¸âˆ¾âŸœRdim)
Path â‡ "path" Elt "d"âŠ¸â‹ˆâŠ˜(âŠ£âˆ¾"d"â‹ˆâŠ¢)
Text â‡ ("text"Attr"dy"â€¿"0.33em"âŠ¸âˆ¾)âŠ¸EncâŸœEscape
TSize â‡ "font-size"â‹ˆNumâˆ¾"px"Ë™
