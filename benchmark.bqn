#! /usr/bin/env bqn

types â† "measure"â€¿"plot"â€¿"all"â€¿"help"
type â† âŠ‘ types âŠ 1â†‘â€¢args

Exit â† â€¢Exitâˆ˜âŠ£âŸœâ€¢Out
âŸ¨AtâŸ© â† â€¢file

{type<1-Ëœâ‰ types?@;
  0 Exit "Usage: benchmark.bqn (help|measure|plot|all) [functions...]"
}

{1<â‰ â€¢args?@; 1 Exit "No functions specified" }

fns â† â€¢Importâˆ˜("functions"Atâˆ¾âŸœ".bqn")âŠ@Â¨ fnames â† 1â†“â€¢args

{0=â‰ ğ•©?@; 1 Exit âˆ¾"Unknown functions: "âŒ¾âŠ‘â¥Š(<", ")â‰Ë˜ğ•© } (fnsâ‰¡Â¨@)/fnames

âŸ¨TimeFnâŸ© â† â€¢Import "measure/time.bqn"
scale    â† â€¢Import "measure/scale.bqn"
âŸ¨LinePlotâ‡PlotâŸ© â† â€¢Import "plot/line.bqn"

All â† {
  Time â‡ TimeFn ğ•©.TimeParams
  TimeÂ¨ ğ•©.timeInit

  y â† 1e9Ã—xÃ·Ëœ TimeÂ¨ x â† scale.E13 ğ•©.xmax
  ("output/plot"Atğ•©.nameâˆ¾".svg") â€¢file.Chars ğ•©.plotOpts LinePlot 1â†“Â¨xâ‹ˆy
}
Measure â† Plot â† !

(typeâŠ‘Measureâ€¿Plotâ€¿All)Â¨ fns
