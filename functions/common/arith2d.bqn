# Insert Ë and Scan ` on rank-2 arrays
âŸ¨basenameâ‡name, _opâŸ© â† âŠ‘â€¢args

tname â† (-Â´"Aa")âŠ¸+âŒ¾âŠ‘ basename
oname â† â€¢Repr op

âŸ¨RandBoolâŸ© â† â€¢Import "../../measure/gen.bqn"
scales     â† â€¢Import "../../measure/scale.bqn"
cputypes   â† â€¢Import "../../params/cputype.bqn"
nsâ†{minâ‡0.01}â€¢Import "../../params/ns_v.bqn"

Bench2d â† { mextâ€¿modâ€¿mname ğ•Š dat:
  âŸ¨paramsâŸ© â‡ extâ€¿fnameâ€¿argâ€¿GetTime â† dat
  plotname â‡ âˆ¾tname   â€¿mextâ€¿" "â€¿fnameâ€¿mnameâ€¿" of "â€¿argâ€¿" "â€¿"rank 2 array"
  name     â‡ âˆ¾basenameâ€¿mextâ€¿"-2d-"â€¿ext
  total â† 10â‹†eâ†4
  input â‡ {
    name â‡ "Width"
    range â‡ 1.5 scales._exp2d total
  }
  result â‡ ns
  Measure â‡ {
    Flip â† totalâŒˆâˆ˜Ã·âŠ¢  # Length of other dimension
    Len â‡ FlipâŠ¸Ã—
    TimeParams â‡ (mod GetTime ğ•©)âˆ˜(FlipâŠ¸â‹ˆ)
    timeInit â‡ 1e5â€¿1â€¿1e3
  }
  plotOpts â‡ {
    title â‡ plotname
    x â‡ input
    y â‡ result
    key â‡ âŠ‘params
  }
}

BoolDat â† { ext ğ•Š fns:
  extâ‡ â‹„ fname â‡ "F" â‹„ arg â‡ "boolean"
  params â‡ âŸ¨âŸ¨fnsâŸ© â€¢Import "../../params/logic.bqn"âŸ©
  GetTime â‡ { mod ğ•Š âŸ¨fnâŸ©: { âŸ¨Fn _mod, RandBoolâˆ˜ğ•©âŸ© } }
}

ArithDat â† { ext ğ•Š fn:
  extâ‡ â‹„ fname â‡ â€¢Repr fn â‹„ arg â‡ "numeric"
  params â‡ âŸ¨cputypesâŸ©
  GetTime â‡ { mod ğ•Š âŸ¨typeâŸ©: { âŸ¨Fn _mod, type.GetGenğ•©âŸ© } }
}

mods â† âŸ¨
  ""      â€¿  _op  â€¿ oname
  "-cells"â€¿{ğ”½_opË˜}â€¿(onameâˆ¾"Ë˜")
âŸ©
mods Bench2dâŒœ âŸ¨
  "boolean" BoolDat âˆ§â€¿âˆ¨â€¿=â€¿â‰ â€¿+â€¿-
  "boolcmp" BoolDat <â€¿>â€¿â‰¤â€¿â‰¥
  "plus" ArithDat {+}
  "min"  ArithDat {âŒŠ}
âŸ©
