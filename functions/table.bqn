# Table modifier

name â‡ "table"

types â† â€¢Import "../params/cputype.bqn"
fns â† âŸ¨âŠâŸ¨âŒˆâŸ©âŸ© â€¢Import "../params/arith.bqn"
params â‡ typesâ€¿fns

xmax â† 1e5
Measure â‡ { ğ•Š typeâ€¿fn:
  floatâ€¿sizeâ€¿max â† type
  Flip â† xmaxâŒˆâˆ˜Ã·âŠ¢  # Length of other dimension
  scale â‡ {(âŠ¢âˆ¾Flipâˆ˜âŒ½) â· âŒˆ ğ•© â‹† (2âŠ¸Ã—Ã·Ëœ0âˆ¾0.5+â†•) âŒˆ2Ã·Ëœ âŒˆ1.3â‹†â¼ğ•©} xmax
  Result â‡ {xğ•Šy: xâ‹ˆ1e9Ã—yÃ·FlipâŠ¸Ã—x}
  GetGen â† {
    âŸ¨RandâŸ© â† âŸ¨ğ•©âŸ© â€¢Import "../measure/gen.bqn"
    (âŒˆ(1âŒˆmax)Ã·2) -Ëœ ğ•© Rand maxË™
  }
  TimeParams â‡ { âŸ¨fnâŒœâŸ© âˆ¾ â‹ˆâ—‹GetGenâŸœFlip ğ•© }
  timeInit â‡ 1e4â€¿1â€¿1e3
}

PlotPre â‡ âŒ½
plotOpts â‡ {
  title â‡ "Arithmetic âŒˆâŒœ with 1e5-element result"
  x â‡ {nameâ‡"Left argument length"}
  y â‡ {nameâ‡"Time (ns / value)"}
  labels â‡ {ğ•©.label}Â¨ âŒ½types.range
}
