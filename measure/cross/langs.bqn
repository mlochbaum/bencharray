# Language definitions for cross-language benchmarks
# - name
# - extension: script is ./avgtime.{extension}
# - shell: command to run a file
# - FmtFn: convert BQN function to source in that language

fnsâ€¿fndâ€¿fnj â† (âŠ‘Â¨<âŠ¸âˆ¾Â·{<Ë˜â‰>>ğ•©}((2â¥Šâ‹ˆâŸ(1â‰¥â‰¡))Â¨Â·(2âŒŠâˆ˜Ã·Ëœâ‰ )âŠ¸(-âŠ¸â†“â‹ˆâ†“)Â·âŠ‘âŸ(1=â‰ )1â†“âŠ¢)Â¨) âŸ¨
  +â€¿"+", Ã—â€¿"Ã—*", â‹†â€¿"*^"
  -â€¿"-", Ã·â€¿"Ã·%", âˆšâ€¿"*âˆ˜(Ã·2)"â€¿"*âˆ˜Ã·â¨"â€¿"%:"â€¿"%:"
  âŒŠâ€¿"âŒŠ"â€¿"<.",    |â€¿"|"
  âŒˆâ€¿"âŒˆ"â€¿">.",    Â¬â€¿"1+-"â€¿"~"â€¿"1+-"â€¿"-."
  âˆ§â€¿"{(âŠ‚â‹âµ)âŒ·âµ}"â€¿"âˆ§"â€¿"/:~"â€¿"*."
  âˆ¨â€¿"{(âŠ‚â’âµ)âŒ·âµ}"â€¿"âˆ§"â€¿"/:~"â€¿"*."
  <â€¿"âŠ‚"â€¿"<"â€¿"<"â€¿"<", â‰¤â€¿"â‰¤"â€¿"<:"
  >â€¿"â†‘"â€¿">"â€¿">"â€¿">", â‰¥â€¿"â‰¥"â€¿">:"
  â‰ â€¿"â‰¢"â€¿"â‰ "â€¿"#"â€¿"~:"
  =â€¿"â‰¢âˆ˜â´"â€¿"="â€¿"#@$"â€¿"="
  â‰¡â€¿"â‰¡"â€¿("L:"â€¿"-:")
  â‰¢â€¿"â´"â€¿"â‰¢"â€¿"$"â€¿"-.@-:"
  âŠ£â€¿"âŠ£["
  âŠ¢â€¿"âŠ¢]"
  â¥Šâ€¿","â€¿"â´"â€¿","â€¿"$"
  âˆ¾â€¿"(âŠƒ,/)"â€¿"âª"â€¿";"â€¿"," # Lists only for monadic
  â†‘â€¿"â†‘"â€¿"{."  # Assume dyadic
  â†“â€¿"â†“"â€¿"}."  # Assume dyadic
  âŒ½â€¿"âŒ½"â€¿"|."
  â‰â€¿"â‰"â€¿"|:"  # J dyadic doesn't work
  /â€¿"â¸"â€¿"âŒ¿"â€¿"I."â€¿"#"
  â‹â€¿"â‹"â€¿"â¸"â€¿"/:"â€¿"I."
  â’â€¿"â’"â€¿"" â€¿"\:"â€¿""
  âŠâ€¿"âŠ£âŒ¿"â€¿"âŒ·â¨âˆ˜âŠ‚â¨"â€¿"{."â€¿"{"
  âŠâ€¿"(âˆªâ³âŠ¢)"â€¿"â³"â€¿"(i.~~.)"â€¿"i."
  âˆŠâ€¿"â‰ "â€¿"âˆŠ"â€¿"~:"â€¿"e."
  â·â€¿"âˆª"â€¿"â·"â€¿"~."â€¿"E."
  # Not covered: â‰â‹ˆâ†•Â«Â»âŠ‘âŠ’âŠ”!
âŸ©
mdsâ€¿mdvâ€¿mddâ€¿mdj â† <Ë˜ {âˆ¾âŸœğ•}âŸ(3>â€¢Type)Â¨âŒ¾(2âŠ¸â†“) â‰ [
  Ë˜â€¿0â€¿"â¤Â¯1"â€¿"""_1"
  Â¨â€¿0â€¿"Â¨"â€¿"&.>"
  âŒœâ€¿0â€¿("âˆ˜."âˆ¾("("âˆ¾âˆ¾âŸœ")")âŸ(1<â‰ ))â€¿"/"
  â¼â€¿0â€¿("âŸ"âŠ£"*"â¼)â€¿("^."âŠ£"^"â¼)
  Â´â€¿2â€¿"/"â€¿"/"
  Ëâ€¿2â€¿"âŒ¿"â€¿"/"
  `â€¿2â€¿"â€"â€¿"/\"
]

_fmtLang_ â† {
  tâ€¿d â† (âŠ‘â‹ˆ1âŠ¸â†“) â€¢Decompose ğ•©
  Pâ†"("âˆ¾âˆ¾âŸœ")" â‹„ F â† ğ•¨ğ•ŠâŠ¢ â‹„ Tr â† PÂ·âˆ¾FÂ¨
  tâ—¶âŸ¨
    ğ•— âŠ‘Ëœ (ğ•¨-1)â‹ˆÂ·âŠ‘fnsâŠ¸âŠ    # 0 primitive
    !, Tr, Tr             # 1 block, 2/3 train
    mdsâŠ¸âŠâŒ¾<âŠ¸(âŠ‘âŸœğ•˜{ğ•ğ•©}(ğ•¨âŠ£âŸ(â‰ âŸœ0)ËœâŠ‘âŸœmdv)âŠ¸ğ•Š)ËœÂ´ # 4 1-modifier
    !                     # 5 2-modifier
  âŸ© d
}

"extendlangs.bqn" â€¢ImportËœâŸ(â€¢file.ExistsâŠ£) âŸ¨
  {
    shell â‡ â‹ˆ extensionâ‡name â‡ "bqn"
    FmtFn â‡ â€¢ReprâŠ¢
  }
  {
    name â‡ "j"
    extension â‡ "ijs"
    shell â‡ "j9"â€¿"-c"  # âŸ¨"jconsole"âŸ©
    FmtFn â‡ fnj _fmtLang_ mdj
  }
  {
    extensionâ‡name â‡ "dyalog"
    shell â‡ âŸ¨"dyalogscript","MAXWS=2G"âŸ©
    FmtFn â‡ fnd _fmtLang_ mdd
  }
âŸ©
