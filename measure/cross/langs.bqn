# Language definitions for cross-language benchmarks
# - name
# - extension: script is ./avgtime.{extension}
# - shell: command to run a file
# - FmtFn: convert BQN function to source in that language

fns‿fnd‿fnj ← (⊑¨<⊸∾·{<˘⍉>>𝕩}((2⥊⋈⍟(1≥≡))¨·(2⌊∘÷˜≠)⊸(-⊸↓⋈↓)·⊑⍟(1=≠)1↓⊢)¨) ⟨
  +‿"+", ×‿"×*", ⋆‿"*^"
  -‿"-", ÷‿"÷%", √‿"*∘(÷2)"‿"*∘÷⍨"‿"%:"‿"%:"
  ⌊‿"⌊"‿"<.",    |‿"|"
  ⌈‿"⌈"‿">.",    ¬‿"1+-"‿"~"‿"1+-"‿"-."
  ∧‿"{(⊂⍋⍵)⌷⍵}"‿"∧"‿"/:~"‿"*."
  ∨‿"{(⊂⍒⍵)⌷⍵}"‿"∧"‿"/:~"‿"*."
  <‿"⊂"‿"<"‿"<"‿"<", ≤‿"≤"‿"<:"
  >‿"↑"‿">"‿">"‿">", ≥‿"≥"‿">:"
  ≠‿"≢"‿"≠"‿"#"‿"~:"
  =‿"≢∘⍴"‿"="‿"#@$"‿"="
  ≡‿"≡"‿("L:"‿"-:")
  ≢‿"⍴"‿"≢"‿"$"‿"-.@-:"
  ⊣‿"⊣["
  ⊢‿"⊢]"
  ⥊‿","‿"⍴"‿","‿"$"
  ∾‿"(⊃,/)"‿"⍪"‿";"‿"," # Lists only for monadic
  ↑‿"↑"‿"{."  # Assume dyadic
  ↓‿"↓"‿"}."  # Assume dyadic
  ⌽‿"⌽"‿"|."
  ⍉‿"⍉"‿"|:"  # J dyadic doesn't work
  /‿"⍸"‿"⌿"‿"I."‿"#"
  ⍋‿"⍋"‿"⍸"‿"/:"‿"I."
  ⍒‿"⍒"‿"" ‿"\:"‿""
  ⊏‿"⊣⌿"‿"⌷⍨∘⊂⍨"‿"{."‿"{"
  ⊐‿"(∪⍳⊢)"‿"⍳"‿"(i.~~.)"‿"i."
  ∊‿"≠"‿"∊"‿"~:"‿"e."
  ⍷‿"∪"‿"⍷"‿"~."‿"E."
  # Not covered: ≍⋈↕«»⊑⊒⊔!
⟩

⟨
  {
    shell ⇐ ⋈ extension⇐name ⇐ "bqn"
    FmtFn ⇐ •Repr⊢
  }
  {
    name ⇐ "j"
    extension ⇐ "ijs"
    shell ⇐ "j9"‿"-c"  # ⟨"jconsole"⟩
    FmtFn ⇐ fnj ⊑˜ -⟜1⊸⋈⟜(fns⊸⊐⌾<)
  }
  {
    extension⇐name ⇐ "dyalog"
    shell ⇐ ⟨"dyalogscript","MAXWS=2G"⟩
    FmtFn ⇐ fnd ⊑˜ -⟜1⊸⋈⟜(fns⊸⊐⌾<)
  }
⟩
